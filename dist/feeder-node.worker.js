(()=>{"use strict";function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var t=function(){function t(e,a,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.inputSampleRate=e,this.outputSampleRate=a,this.nChannels=n,this._resampleFractional=0,this._resampleLastSampleData=void 0}var a,n;return a=t,(n=[{key:"resample",value:function(e){var t=this.inputSampleRate,a=this.nChannels,n=this.outputSampleRate;if(t==n)return e;var r,l=[],o=e[0].length,i=this._resampleFractional,h=o*n/t+i,s=Math.floor(h),u=h-s;r=t<n?function(e,a,r,l){for(var o=function(t){return t<0?r&&r.length+t>0?r[r.length+t]:e[0]:e[t]},h=0;h<a.length;h++){var s,u=(h+1-i)*t/n-1,f=Math.floor(u),c=Math.ceil(u);s=f==c?o(f):o(f)*(c-u)+o(c)*(u-f),a[h]=s}}:function(e,t,a){for(var n=0;n<t.length;n++)t[n]=e[n*e.length/t.length|0]};for(var f=0;f<a;f++){var c=f,p=e[c],m=new Float32Array(s);r(p,m,this._resampleLastSampleData?this._resampleLastSampleData[c]:void 0),l.push(m)}return this._resampleFractional=u,this._resampleLastSampleData=e,l}}])&&e(a.prototype,n),t}();let a,n,r;onmessage=function(e){if("feed"==e.data.command){let t=function(e,t){if(!Number.isInteger(t))throw"nChannels must be an integer";var a=e.length/t,n=Array.apply(null,Array(t)).map((function(e,t){return new Float32Array(a)}));return function(e,t){if(e.length>t[0].length*t.length)throw"incorrect channel lengths";for(var a=0;a<t.length;a++)for(var n=a,r=0;r<t[a].length;r++)t[a][r]=e[n],n+=t.length}(e,n),n}(new Float32Array(e.data.data),r),l=function(e){var t=e[0].length*e.length,a=new Float32Array(t);return function(e,t){if(t.length<e[0].length*e.length)throw Error("incorrect channel lengths");for(var a=0,n=0;n<e[0].length;n++)for(var r=0;r<e.length;r++)t[a++]=e[r][n]}(e,a),a}(n.resample(t));null==a?postMessage(l,[l.buffer]):a.postMessage({command:"feed",data:l},[l.buffer])}else if("connect"===e.data.command)a=e.ports[0];else{if("init"!==e.data.command)throw"received unrecognized command";r=e.data.nChannels,n=new t(e.data.inputSampleRate,e.data.outputSampleRate,r)}}})();